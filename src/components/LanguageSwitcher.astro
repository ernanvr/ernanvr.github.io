---
import {
  SUPPORTED_LOCALES,
  getLocaleFromPath,
  localizePath,
  LOCALE_INFO,
} from "@i18n/utils";

export interface Props {
  ariaLabel?: string;
}

const { ariaLabel = "Language switcher" } = Astro.props;
const currentLocale = getLocaleFromPath(Astro.url.pathname);
---

<div class="locale-switcher" aria-label={ariaLabel}>
  {
    SUPPORTED_LOCALES.map(locale => (
      <a
        href={localizePath(Astro.url.pathname, locale)}
        class:list={[
          "locale-link",
          currentLocale === locale && "locale-link-active",
        ]}
        aria-current={currentLocale === locale ? "true" : "false"}
      >
        <span>{LOCALE_INFO[locale].code}</span>
      </a>
    ))
  }
</div>

<style>
  .locale-switcher {
    @apply flex items-center justify-center gap-1;
  }

  .locale-link {
    @apply inline-flex h-11 min-w-11 items-center justify-center rounded-md border border-transparent px-3 py-2 text-sm font-semibold no-underline opacity-85 hover:border-skin-line/80 hover:bg-skin-card/70 hover:text-skin-accent hover:opacity-100 sm:h-8 sm:min-w-9 sm:px-2 sm:py-1 sm:text-xs;
  }

  .locale-link-active {
    @apply border-skin-line bg-skin-card text-skin-accent opacity-100 no-underline;
  }
</style>
